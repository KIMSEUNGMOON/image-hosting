name: 자동 이미지 업로드

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
      - name: 저장소 체크아웃
        uses: actions/checkout@v3

      - name: Git 설정
        run: |
          git config --global user.email "naamnyam@e-inteco.co.kr"
          git config --global user.name "KIMSEUNGMOON"

      - name: 이미지 업로드 처리 (변경된 파일이 있을 때만 실행)
        run: |
          CHANGED_FILES=$(git status --porcelain images/ | wc -l)
          if [ "$CHANGED_FILES" -gt "0" ]; then
            echo "변경된 파일이 존재합니다. GitHub에 업로드합니다."
            git add images/*
            git commit -m "GitHub Actions 자동 업로드"
            git push origin main
          else
            echo "변경된 파일이 없습니다. 스크립트를 종료합니다."
            exit 0
          fi
